<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoMessager å®Œæ•´åŠŸèƒ½æ¨¡æ‹Ÿå™¨ v0.0.1.3</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', system-ui, sans-serif; }
        
        /* æ¨¡æ‹Ÿ Windows ç»å…¸å­—ä½“ */
        .win-font { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .win-mono { font-family: 'Consolas', 'Courier New', monospace; }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }

        /* æ¨¡æ‹Ÿ Windows æŒ‰é’®æŒ‰ä¸‹çš„æ•ˆæœ */
        .win-btn {
            background-color: #e1e1e1;
            border: 1px solid #adadad;
            border-radius: 2px;
            transition: all 0.1s;
        }
        .win-btn:hover { background-color: #e5f1fb; border-color: #0078d7; }
        .win-btn:active { background-color: #cce4f7; border-color: #005499; }
        
        /* å·¨å¤§çš„å¼€å…³æŒ‰é’®æ ·å¼ */
        .big-switch {
            background-color: #e1e1e1;
            border: 2px solid #0078d7; 
        }

        /* çŠ¶æ€ç¯ */
        .status-box {
            width: 100%;
            height: 100px;
            border: 1px solid #999;
        }

        /* åŠ¨ç”» */
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .pulse { animation: pulse 2s infinite; }
        
        /* å¯†æ–‡æ ·å¼ */
        .cipher-text {
            color: #e2b714;
            font-family: 'Consolas', monospace;
            background: rgba(0,0,0,0.2);
            padding: 2px 4px;
            border-radius: 2px;
            word-break: break-all;
        }
        
        .plain-text {
            color: #10b981;
            font-family: 'Consolas', monospace;
        }
        
        /* æ ‡è®°æ ·å¼ */
        .marker {
            color: #3b82f6;
            font-weight: bold;
        }
        
        /* ä»£ç å—æ ·å¼ */
        .code-block {
            background: rgba(0,0,0,0.3);
            border-left: 3px solid #3b82f6;
            padding: 10px;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            border-radius: 0 4px 4px 0;
        }
        
        /* å‘½ä»¤æç¤ºç¬¦ */
        .cmd-prompt {
            color: #10b981;
            font-family: 'Consolas', monospace;
        }
        
        .cmd-output {
            color: #d1d5db;
            font-family: 'Consolas', monospace;
        }
        
        .cmd-error {
            color: #ef4444;
            font-family: 'Consolas', monospace;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 h-screen overflow-hidden">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- æ ¸å¿ƒé€»è¾‘æ¨¡æ‹Ÿ ---
        const mockEncrypt = (text) => {
            if (text.startsWith("DOFM=")) return text;
            const b64 = btoa(unescape(encodeURIComponent(text)));
            return `DOFM=136b0dc0=${b64.substring(0, 10)}\\${b64.substring(10)}!219M1`;
        };
        
        const mockDecrypt = (cipher) => {
            if (!cipher.startsWith("DOFM=")) return cipher;
            // æ¨¡æ‹Ÿè§£å¯†
            return "Here is something I want to encrypt.";
        };

        const partialEncrypt = (text) => {
            return text.replace(/\*<(.*?)>\*/g, (match, p1) => `*<${mockEncrypt(p1)}>*`);
        };
        
        const partialDecrypt = (text) => {
            return text.replace(/\*<DOFM=(.*?)>\*/g, () => `a1b2c3d4`);
        };

        // æ¨¡æ‹Ÿæ–‡ä»¶åŠ å¯†
        const mockFileEncrypt = () => {
            const id = Math.random().toString(16).substr(2, 8);
            return `Enc_${id}_Rdx6af8.denc.bin`;
        };
        
        // æ¨¡æ‹Ÿæ–‡æœ¬è½¬æ–‡ä»¶åŠ å¯†
        const mockTextToFile = (text) => {
            const id = Math.random().toString(16).substr(2, 8);
            return `Enc_${id}_Rdxd7a2.denc.bin`;
        };

        const App = () => {
            // UI State
            const [activeSection, setActiveSection] = useState(0);
            const [consoleLogs, setConsoleLogs] = useState([
                "[CryptoMessager_GUI Console Helper Version 0.0.1.3]",
                "[Â© DOF Studio/NathMath 2024]",
                "[Version 0.0.1.3 (Built 240721)]",
                "[Released on github.com/dof-studio/CryptoMessager]",
                ">> System Initialized.",
                ">> Ready for operation.",
                ">> Type 'HELP' for command list."
            ]);
            const [isCryptoOn, setIsCryptoOn] = useState(false);
            const [statusColor, setStatusColor] = useState('#008000'); // Green
            const [statusBusy, setStatusBusy] = useState(false);
            const [virtualClipboard, setVirtualClipboard] = useState("");
            const [importValue, setImportValue] = useState("");
            const [clients, setClients] = useState([]);
            const [cmdInput, setCmdInput] = useState("");
            
            // æµ‹è¯•æ•°æ®
            const [testPlaintext, setTestPlaintext] = useState("Here is something I want to encrypt.");
            const [testCiphertext, setTestCiphertext] = useState("DOFM=136b0dc0=bu0gws5\\7bfpnmTVnpw&r0{Q0c7QopxN9@)F61FS!2+Zjtgx`fXE3vj9nSqvsDs(m3s@GU9IkAfBSCwB5bfGlIj+8!219M1");
            const [testPartialText, setTestPartialText] = useState("Emma, I think we should adjust our investment positions.\nWe need to invest in some more S&P 500 ETF funds.\nThe password of the account is *<a1b2c3d4>*.\nCould you please help me operate it?");
            const [testPartialCipher, setTestPartialCipher] = useState("Emma, I think we should adjust our investment positions.\nWe need to invest in some more S&P 500 ETF funds.\nThe password of the account is *<DOFM=136b0dc0=4)Aqb]`r2r{ok\\foe^90ng5\\95iDv(spsNg^n9U6wz6w1>*.\nCould you please help me operate it?");
            const [testLongText, setTestLongText] = useState("Emma, this is pi to 1'000'000 decimal places: 3.14159265358979323846264338327950288...");
            
            // æ–‡ä»¶æ¨¡æ‹Ÿ
            const [selectedFiles, setSelectedFiles] = useState([
                "D:/Emma/Love Letter.txt",
                "D:/President/Election Manifesto.mp4", 
                "D:/Secret/Amazing Novels/"
            ]);
            
            // SMS Code Telepathy
            const [telepathyMode, setTelepathyMode] = useState(null); // null, 'server', 'client'
            const [telepathyPassword, setTelepathyPassword] = useState("");
            const [linkCode, setLinkCode] = useState("");
            
            // å‘½ä»¤è¡Œå†å²
            const [cmdHistory, setCmdHistory] = useState([]);
            const [cmdHistoryIndex, setCmdHistoryIndex] = useState(-1);
            
            // Refs
            const consoleEndRef = useRef(null);
            const cmdInputRef = useRef(null);
            const rightPanelRef = useRef(null);
            
            // Auto scroll console
            // useEffect(() => {
            //     consoleEndRef.current?.scrollIntoView({ behavior: "smooth" });
            // }, [consoleLogs]);
            
            // ç„¦ç‚¹åˆ°å‘½ä»¤è¡Œè¾“å…¥
            useEffect(() => {
                if (cmdInputRef.current && activeSection === 6) {
                    cmdInputRef.current.focus();
                }
            }, [activeSection]);

            const addLog = (msg, type = "info") => {
                const timestamp = new Date().toLocaleTimeString();
                let prefix = ">>";
                
                if (type === "error") {
                    prefix = "!! ERROR:";
                } else if (type === "success") {
                    prefix = "<< SUCCESS:";
                } else if (type === "warning") {
                    prefix = "?? WARNING:";
                } else if (type === "cmd") {
                    prefix = "$";
                }
                
                setConsoleLogs(prev => [...prev, `${prefix} ${timestamp} ${msg}`]);
            };

            // Toggle Logic
            const toggleCrypto = () => {
                if (statusBusy) {
                    addLog("System is busy, please wait...", "warning");
                    return;
                }
                
                if (isCryptoOn) {
                    setIsCryptoOn(false);
                    setStatusColor('#008000'); // Green
                    addLog("Turned Crypto OFF!", "info");
                } else {
                    setIsCryptoOn(true);
                    setStatusColor('#FF0000'); // Red
                    addLog("Turned Crypto ON!", "success");
                }
            };

            // æ¨¡æ‹Ÿç¹å¿™çŠ¶æ€
            const simulateBusy = (duration = 800, callback) => {
                setStatusBusy(true);
                setStatusColor('#FFFF00'); // Yellow (Busy)
                
                setTimeout(() => {
                    setStatusBusy(false);
                    setStatusColor(isCryptoOn ? '#FF0000' : '#008000');
                    if (callback) callback();
                }, duration);
            };

            // Copy Simulation Logic
            const handleSimulateCopy = (text, operation = "copy") => {
                if (!isCryptoOn && operation === "encrypt") {
                    addLog("Crypto is OFF. No encryption performed.", "warning");
                    setVirtualClipboard(text);
                    return;
                }
                
                if (operation === "decrypt" && !clients.length) {
                    addLog("Cannot decrypt: No clients added. Add sender's SMS Code first.", "error");
                    return;
                }
                
                setVirtualClipboard(text);
                addLog(`Clipboard updated: ${text.substring(0, 30)}...`, "info");
                
                if (isCryptoOn) {
                    simulateBusy(800, () => {
                        let result = text;
                        
                        // åŠ å¯†æ“ä½œ
                        if (operation === "encrypt") {
                            if (text.includes("*<") && text.includes(">*")) {
                                result = partialEncrypt(text);
                                addLog("Partial Encryption Complete.", "success");
                            } else if (text.startsWith("====!!!!") || text.endsWith("====!!!!")) {
                                result = `"${mockTextToFile(text)}" 792KB`;
                                addLog("Text converted to encrypted file.", "success");
                            } else {
                                result = mockEncrypt(text);
                                addLog("Text Encrypted.", "success");
                            }
                        } 
                        // è§£å¯†æ“ä½œ
                        else if (operation === "decrypt") {
                            if (text.includes("*<DOFM=")) {
                                result = partialDecrypt(text);
                                addLog("Partial Ciphertext Decrypted.", "success");
                            } else if (text.startsWith("DOFM=")) {
                                result = mockDecrypt(text);
                                addLog("Ciphertext Decrypted.", "success");
                            } else if (text.includes(".denc.bin")) {
                                // æ–‡ä»¶è§£å¯†
                                result = `Files extracted to D:/tmp/\n- Love Letter.txt\n- Election Manifesto.mp4\n- Amazing Novels/`;
                                addLog("File archive decrypted.", "success");
                            } else {
                                addLog("Not a recognizable ciphertext.", "warning");
                            }
                        }
                        
                        setVirtualClipboard(result);
                    });
                }
            };

            // æ–‡ä»¶åŠ å¯†æ¨¡æ‹Ÿ
            const handleFileEncrypt = () => {
                if (!isCryptoOn) {
                    addLog("Turn Crypto ON first to encrypt files.", "warning");
                    return;
                }
                
                simulateBusy(1200, () => {
                    const encryptedFile = `"${mockFileEncrypt()}" 477MB`;
                    setVirtualClipboard(encryptedFile);
                    addLog("File structure encrypted to archive.", "success");
                });
            };

            // Button Actions
            const handleShareMe = () => {
                if (telepathyMode === null) {
                    const choice = confirm("ä½¿ç”¨ SMS Code Telepathy (P2P) å—ï¼Ÿ\nç‚¹å‡»ç¡®å®šè¿›å…¥ Telepathy æ¨¡å¼ï¼Œå–æ¶ˆåˆ™ç”Ÿæˆæœ¬åœ° SMS Codeã€‚");
                    
                    if (!choice) {
                        // æ™®é€š SMS Code ç”Ÿæˆ
                        const code = "DOFM=136b0dc0=bu0gws5\\7bfpnmTVnpw&r0{Q0c7QopxN9@)F61FS!2+Zjtgx`fXE3vj9nSqvsDs(m3s@GU9IkAfBSCwB5bfGlIj+8!219M1";
                        addLog(`Your SMS Code: ${code.substring(0, 30)}...`, "success");
                        setVirtualClipboard(code);
                        setImportValue(code);
                    } else {
                        // Telepathy æ¨¡å¼
                        const serverChoice = confirm("æˆä¸ºæœåŠ¡å™¨ (åˆ›å»ºé“¾æ¥) å—ï¼Ÿ\nç‚¹å‡»ç¡®å®šæˆä¸ºæœåŠ¡å™¨ï¼Œå–æ¶ˆåˆ™ä½œä¸ºè¿æ¥è€…ã€‚");
                        
                        if (serverChoice) {
                            setTelepathyMode('server');
                            addLog("Starting SMS Code Telepathy Server...", "info");
                            
                            // æ¨¡æ‹Ÿç½‘ç»œæµ‹è¯•
                            setTimeout(() => {
                                addLog("Network test passed.", "success");
                                const link = `LNK|${Math.random().toString(16).substr(2, 8)}|192.168.1.100|2001:db8::1|180`;
                                setLinkCode(link);
                                setVirtualClipboard(link);
                                addLog(`Link Code generated: ${link}`, "success");
                                addLog("Share this link and password with counterparty.", "info");
                            }, 1000);
                        } else {
                            setTelepathyMode('client');
                            addLog("Enter Link Code from server to connect.", "info");
                        }
                    }
                } else if (telepathyMode === 'server') {
                    // æœåŠ¡å™¨æ¨¡å¼ï¼Œå·²æœ‰é“¾æ¥
                    addLog("Telepathy link already created. Share link with counterparty.", "info");
                }
            };

            const handleNewClient = () => {
                if (!importValue) {
                    addLog("Import field is empty.", "warning");
                    return;
                }
                
                if (importValue.startsWith("LNK") && telepathyMode === 'client') {
                    // Telepathy è¿æ¥
                    const password = prompt("Enter password for Telepathy link:");
                    if (password === "TempPass123") {
                        simulateBusy(1500, () => {
                            addLog("SMS Codes Successfully Exchanged!", "success");
                            setClients(prev => [...prev, { id: Date.now(), name: "Remote User", code: importValue }]);
                            setImportValue("");
                            setTelepathyMode(null);
                        });
                    } else {
                        addLog("Invalid password input!", "error");
                    }
                } else if (importValue.startsWith("DOFM=")) {
                    // æ™®é€š SMS Code æ·»åŠ 
                    const clientName = importValue === "DOFM=136b0dc0=bu0gws5\\7bfpnmTVnpw&r0{Q0c7QopxN9@)F61FS!2+Zjtgx`fXE3vj9nSqvsDs(m3s@GU9IkAfBSCwB5bfGlIj+8!219M1" 
                        ? "Self (æœ¬åœ°ç”¨æˆ·)" 
                        : "Remote Client";
                    
                    setClients(prev => [...prev, { id: Date.now(), name: clientName, code: importValue }]);
                    addLog(`Client Added: ${clientName}`, "success");
                    setImportValue("");
                } else {
                    addLog("Invalid SMS Code or Link Code format.", "error");
                }
            };
            
            const handleDeleteMe = () => {
                if (clients.length === 0) {
                    addLog("No clients to delete.", "warning");
                    return;
                }
                
                const delCode = prompt("Enter DEL Code to delete client:");
                if (delCode) {
                    setClients([]);
                    addLog("All clients deleted with DEL Code.", "info");
                }
            };
            
            const handleClearConsole = () => {
                setConsoleLogs([
                    "[CryptoMessager_GUI Console Helper Version 0.0.1.3]",
                    "[Â© DOF Studio/NathMath 2024]",
                    "[Version 0.0.1.3 (Built 240721)]",
                    "[Released on github.com/dof-studio/CryptoMessager]",
                    ">> Console cleared."
                ]);
            };
            
            // å‘½ä»¤è¡Œå¤„ç†å‡½æ•°
            const executeCommand = (cmdLine) => {
                if (!cmdLine.trim()) return;
                
                // æ·»åŠ åˆ°å†å²
                setCmdHistory(prev => [...prev.slice(-9), cmdLine]); // åªä¿ç•™æœ€è¿‘10æ¡
                setCmdHistoryIndex(-1);
                
                // æ˜¾ç¤ºå‘½ä»¤
                addLog(`$ ${cmdLine}`, "cmd");
                
                const parts = cmdLine.trim().split(/\s+/);
                const cmd = parts[0].toUpperCase();
                const args = parts.slice(1);
                
                // æ‰§è¡Œå‘½ä»¤
                switch(cmd) {
                    case 'ON':
                    case 'TURNON':
                        if (!isCryptoOn) toggleCrypto();
                        else addLog("Crypto is already ON.", "info");
                        break;
                        
                    case 'OFF':
                    case 'TURNOFF':
                        if (isCryptoOn) toggleCrypto();
                        else addLog("Crypto is already OFF.", "info");
                        break;
                        
                    case 'SW':
                    case 'SWITCH':
                        toggleCrypto();
                        break;
                        
                    case 'C':
                    case 'CLR':
                    case 'CLS':
                        handleClearConsole();
                        break;
                        
                    case 'CLC':
                    case 'CLRCLIP':
                        setVirtualClipboard("");
                        addLog("Clipboard cleared.", "success");
                        break;
                        
                    case 'MYS':
                    case 'MYSMS':
                        const smsCode = "DOFM=136b0dc0=bu0gws5\\7bfpnmTVnpw&r0{Q0c7QopxN9@)F61FS!2+Zjtgx`fXE3vj9nSqvsDs(m3s@GU9IkAfBSCwB5bfGlIj+8!219M1";
                        addLog(`Your SMS Code: ${smsCode}`, "info");
                        break;
                        
                    case 'MYSCPY':
                    case 'MYSMSCPY':
                        const smsCode2 = "DOFM=136b0dc0=bu0gws5\\7bfpnmTVnpw&r0{Q0c7QopxN9@)F61FS!2+Zjtgx`fXE3vj9nSqvsDs(m3s@GU9IkAfBSCwB5bfGlIj+8!219M1";
                        setVirtualClipboard(smsCode2);
                        addLog("SMS Code copied to clipboard.", "success");
                        break;
                        
                    case 'ADD':
                    case 'NEW':
                        if (args.length === 1) {
                            setImportValue(args[0]);
                            setTimeout(() => {
                                handleNewClient();
                            }, 100);
                        } else {
                            addLog("Usage: ADD <SMS_Code>", "error");
                        }
                        break;
                        
                    case 'DEL':
                    case 'DELETE':
                        if (args.length === 1) {
                            setClients([]);
                            addLog(`Client deleted with DEL Code: ${args[0]}`, "info");
                        } else {
                            addLog("Usage: DEL <DEL_Code>", "error");
                        }
                        break;
                        
                    case 'D':
                    case 'DO':
                    case 'DIRECTLY':
                        if (virtualClipboard) {
                            if (virtualClipboard.startsWith("DOFM=")) {
                                handleSimulateCopy(virtualClipboard, "decrypt");
                            } else {
                                handleSimulateCopy(virtualClipboard, "encrypt");
                            }
                        } else {
                            addLog("Clipboard is empty.", "warning");
                        }
                        break;
                        
                    case 'H':
                    case 'HELP':
                        if (args.length === 0) {
                            const helpText = `Available commands: ON, OFF, SWITCH, CLS, CLC, MYSMS, MYSMSCPY, ADD, DEL, DIRECTLY, SAVE, MIN, QUIT, HINT, RET, UPD, HELP`;
                            addLog(helpText, "info");
                            setVirtualClipboard(helpText);
                        } else if (args.length === 1) {
                            const cmdHelp = args[0].toUpperCase();
                            const helpMap = {
                                'ON': 'Turn ON the real-time encrypting system immediately.',
                                'OFF': 'Turn OFF the real-time encrypting system immediately.',
                                'SWITCH': 'Toggle ON/OFF the real-time encrypting system.',
                                'CLS': 'Clear the console screen.',
                                'CLC': 'Clear your clipboard.',
                                'MYSMS': 'Print your local SMS Code.',
                                'MYSMSCPY': 'Copy your SMS Code to clipboard.',
                                'ADD': 'Add a new client: ADD <SMS_Code>',
                                'DEL': 'Delete a client: DEL <DEL_Code>',
                                'DIRECTLY': 'Encrypt/decrypt clipboard content.',
                                'SAVE': 'Save database to drive.',
                                'MIN': 'Minimize window.',
                                'QUIT': 'Exit CryptoMessager.',
                                'HINT': 'Toggle HintLight.',
                                'RET': 'Get last feedback.',
                                'UPD': 'Check for updates.',
                                'HELP': 'Show this help.'
                            };
                            
                            if (helpMap[cmdHelp]) {
                                addLog(`${cmdHelp}: ${helpMap[cmdHelp]}`, "info");
                            } else {
                                addLog(`No help found for command: ${cmdHelp}`, "warning");
                            }
                        }
                        break;
                        
                    case 'S':
                    case 'SAV':
                    case 'SAVE':
                        addLog("Database saved to drive.", "success");
                        break;
                        
                    case 'M':
                    case 'MIN':
                        addLog("Window minimized (simulated).", "info");
                        break;
                        
                    case 'Q':
                    case 'QUIT':
                        if (confirm("Are you sure you want to exit CryptoMessager?")) {
                            addLog("Exiting CryptoMessager...", "info");
                            // æ¨¡æ‹Ÿé€€å‡º
                            setTimeout(() => {
                                alert("CryptoMessager closed (simulation). Refresh page to restart.");
                            }, 500);
                        }
                        break;
                        
                    case 'HT':
                    case 'HINT':
                        addLog("HintLight toggled (simulated).", "info");
                        break;
                        
                    case 'R':
                    case 'RET':
                    case 'INFO':
                        addLog("Last feedback: Operation completed successfully.", "info");
                        break;
                        
                    case 'U':
                    case 'UPD':
                        addLog("Checking for updates...", "info");
                        setTimeout(() => {
                            addLog("You are using the latest version (0.0.1.3).", "success");
                        }, 1000);
                        break;
                        
                    case 'W':
                    case 'WEB':
                        addLog("Official website: https://github.com/dof-studio/CryptoMessager", "info");
                        break;
                        
                    default:
                        addLog(`Unknown command: ${cmd}. Type 'HELP' for command list.`, "error");
                }
                
                setCmdInput("");
            };
            
            // å¿«æ·é”®å¤„ç†
            const handleKeyDown = (e) => {
                // å‘½ä»¤è¡Œå†å²å¯¼èˆª
                if (e.key === 'ArrowUp' && cmdHistory.length > 0) {
                    e.preventDefault();
                    const newIndex = cmdHistoryIndex < cmdHistory.length - 1 ? cmdHistoryIndex + 1 : 0;
                    setCmdHistoryIndex(newIndex);
                    setCmdInput(cmdHistory[cmdHistory.length - 1 - newIndex] || "");
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    const newIndex = cmdHistoryIndex > 0 ? cmdHistoryIndex - 1 : -1;
                    setCmdHistoryIndex(newIndex);
                    setCmdInput(newIndex >= 0 ? cmdHistory[cmdHistory.length - 1 - newIndex] : "");
                }
                
                // å‘½ä»¤è¡Œè¾“å…¥æ¡†å›è½¦
                if (e.key === 'Enter' && e.target.id === 'cmd-input') {
                    executeCommand(cmdInput);
                }
                
                // å…¨å±€å¿«æ·é”® (æ¨¡æ‹Ÿ)
                if (e.ctrlKey && e.altKey) {
                    // Ctrl+Alt+O+P = SWITCH
                    if (e.key === 'p' || e.key === 'P') {
                        e.preventDefault();
                        toggleCrypto();
                    }
                    // Ctrl+Alt+K+L = CLS
                    else if (e.key === 'l' || e.key === 'L') {
                        e.preventDefault();
                        handleClearConsole();
                    }
                    // Ctrl+Alt+K+K = CLC
                    else if (e.key === 'k' || e.key === 'K') {
                        e.preventDefault();
                        setVirtualClipboard("");
                        addLog("Clipboard cleared (shortcut).", "success");
                    }
                    // Ctrl+Alt+E+E = DIRECTLY
                    else if (e.key === 'e' || e.key === 'E') {
                        e.preventDefault();
                        if (virtualClipboard) {
                            if (virtualClipboard.startsWith("DOFM=")) {
                                handleSimulateCopy(virtualClipboard, "decrypt");
                            } else {
                                handleSimulateCopy(virtualClipboard, "encrypt");
                            }
                        }
                    }
                }
            };
            
            // æ·»åŠ å¿«æ·é”®ç›‘å¬
            useEffect(() => {
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [isCryptoOn, virtualClipboard, cmdInput, cmdHistory, cmdHistoryIndex]);

            // --- æ•™ç¨‹ç« èŠ‚ ---
            const sections = [
                {
                    id: "startup",
                    title: "ğŸš€ 1. å¯åŠ¨ä¸è®¾ç½®",
                    subtitle: "å¯åŠ¨ç³»ç»Ÿã€ç”ŸæˆSMS Codeã€æ·»åŠ å®¢æˆ·ç«¯",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">å¯åŠ¨ CryptoMessager_GUI ç³»ç»Ÿ</h3>
                            <p className="text-slate-400">é¦–å…ˆéœ€è¦æ·»åŠ è‡ªå·±çš„ SMS Codeï¼Œå¦åˆ™æ— æ³•è§£å¯†è‡ªå·±åŠ å¯†çš„å†…å®¹ã€‚</p>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-green-400 mb-2">æ“ä½œæ­¥éª¤ï¼š</h4>
                                <ol className="list-decimal list-inside space-y-2 text-sm text-slate-300">
                                    <li>ç‚¹å‡»å³ä¾§çš„ <span className="font-bold text-white bg-slate-700 px-1 rounded">Share Me</span> æŒ‰é’®</li>
                                    <li>åœ¨å¼¹çª—ä¸­é€‰æ‹© <span className="font-bold text-white">å–æ¶ˆ (No)</span> ä½¿ç”¨æ™®é€š SMS Code</li>
                                    <li>è§‚å¯Ÿæ§åˆ¶å°ç”Ÿæˆçš„ SMS Code</li>
                                    <li>SMS Code ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿å¹¶å¡«å…¥ Import æ¡†</li>
                                    <li>ç‚¹å‡» <span className="font-bold text-white bg-slate-700 px-1 rounded">New Client</span> æ·»åŠ è‡ªå·±</li>
                                </ol>
                                
                                <div className="mt-4 p-3 bg-slate-900 rounded border border-slate-600">
                                    <h5 className="font-semibold text-blue-400 text-sm mb-2">æ³¨æ„äº‹é¡¹ï¼š</h5>
                                    <ul className="text-xs text-slate-400 space-y-1">
                                        <li>â€¢ ä¸è¦ä»ä¸æ˜æ¥æºè·å–ç¨‹åºï¼Œç¡®ä¿ç¨‹åºå®Œæ•´æ€§</li>
                                        <li>â€¢ æ›´æ–°ç‰ˆæœ¬æ—¶æ³¨æ„æœ¬åœ°æ•°æ®åº“å…¼å®¹æ€§</li>
                                        <li>â€¢ ä¸è¦åœ¨è™šæ‹Ÿæœºæˆ–è°ƒè¯•ç¯å¢ƒä¸­ä½¿ç”¨</li>
                                        <li>â€¢ å‘ç°å¼‚å¸¸æ—¶è€ƒè™‘ç¨‹åºå¯èƒ½è¢«æ¶æ„ç¯¡æ”¹</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    )
                },
                {
                    id: "text-crypto",
                    title: "ğŸ” 2. æ–‡æœ¬åŠ å¯†ä¸è§£å¯†",
                    subtitle: "åŸºç¡€æ–‡æœ¬åŠ å¯†ã€è§£å¯†æ“ä½œ",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">åŠ å¯†æ¶ˆæ¯ä¸ºå¯†æ–‡</h3>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-yellow-400 mb-2">åŠ å¯†æµç¨‹ï¼š</h4>
                                <ol className="list-decimal list-inside space-y-2 text-sm text-slate-300">
                                    <li>ç‚¹å‡»ä¸­é—´çš„ <span className="text-2xl font-bold text-slate-400">OFF</span> æŒ‰é’®å¼€å¯ç›‘æ§</li>
                                    <li>çŠ¶æ€æŒ‡ç¤ºç¯å˜ä¸º <span className="text-red-500">çº¢è‰²</span>ï¼Œæ§åˆ¶å°æç¤º "Turned Crypto ON!"</li>
                                    <li>å¤åˆ¶ä»»æ„æ–‡æœ¬ (æ¨¡æ‹Ÿ Ctrl+C)ï¼Œç¨‹åºä¼šè‡ªåŠ¨åŠ å¯†</li>
                                    <li>å¯†æ–‡ä¼šå‡ºç°åœ¨ç³»ç»Ÿå‰ªè´´æ¿è§†å›¾ä¸­</li>
                                </ol>
                                
                                <div className="mt-4">
                                    <h5 className="font-semibold text-green-400 text-sm mb-2">æµ‹è¯•åŠ å¯†ï¼š</h5>
                                    <div className="flex gap-2">
                                        <textarea 
                                            className="flex-1 bg-slate-900 border border-slate-600 rounded px-2 py-1 text-sm h-20" 
                                            value={testPlaintext}
                                            onChange={(e) => setTestPlaintext(e.target.value)}
                                        />
                                        <div className="flex flex-col gap-2">
                                            <button 
                                                onClick={() => handleSimulateCopy(testPlaintext, "encrypt")}
                                                className="bg-blue-600 hover:bg-blue-500 px-3 py-1 rounded text-sm"
                                            >
                                                æ¨¡æ‹ŸåŠ å¯† (Ctrl+C)
                                            </button>
                                            <button 
                                                onClick={() => handleSimulateCopy(testCiphertext, "decrypt")}
                                                className="bg-green-600 hover:bg-green-500 px-3 py-1 rounded text-sm"
                                            >
                                                æ¨¡æ‹Ÿè§£å¯† (Ctrl+C)
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-blue-400 mb-2">è§£å¯†æµç¨‹ï¼š</h4>
                                <ol className="list-decimal list-inside space-y-2 text-sm text-slate-300">
                                    <li>ç¡®ä¿å·²æ·»åŠ å‘é€è€…çš„ SMS Code</li>
                                    <li>å¼€å¯ç›‘æ§ (çŠ¶æ€æŒ‡ç¤ºç¯ä¸ºçº¢è‰²)</li>
                                    <li>å¤åˆ¶å¯†æ–‡ (æ¨¡æ‹Ÿ Ctrl+C)ï¼Œç¨‹åºä¼šè‡ªåŠ¨è§£å¯†</li>
                                    <li>è§£å¯†åçš„æ˜æ–‡ä¼šå‡ºç°åœ¨å‰ªè´´æ¿ä¸­</li>
                                </ol>
                                
                                <div className="mt-4 text-xs text-slate-500">
                                    <p><span className="font-bold">æ³¨æ„ï¼š</span> è§£å¯†éœ€è¦å·²æ·»åŠ å‘é€è€…çš„ SMS Codeã€‚é•¿æ—¶é—´åŠ å¯†/è§£å¯†æ—¶ï¼ŒçŠ¶æ€æŒ‡ç¤ºç¯ä¼šå˜ä¸ºé»„è‰²ã€‚</p>
                                </div>
                            </div>
                        </div>
                    )
                },
                {
                    id: "partial",
                    title: "ğŸ“ 3. éƒ¨åˆ†æ–‡æœ¬åŠ å¯†",
                    subtitle: "åªåŠ å¯†æ–‡æœ¬ä¸­çš„æ•æ„Ÿéƒ¨åˆ†",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">åªåŠ å¯†æ•æ„Ÿéƒ¨åˆ†</h3>
                            <p className="text-slate-400">æœ‰æ—¶åªæœ‰æ¶ˆæ¯çš„ä¸€éƒ¨åˆ†æ˜¯æ•æ„Ÿçš„ï¼Œæˆ‘ä»¬ä¸æƒ³è®©æ•´ä¸ªæ¶ˆæ¯å¤±å»å¯è¯»æ€§ã€‚</p>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-yellow-400 mb-2">ç¤ºä¾‹æ¶ˆæ¯ï¼š</h4>
                                <div className="code-block text-sm">
                                    Emma, I think we should adjust our investment positions.<br/>
                                    We need to invest in some more S&P 500 ETF funds.<br/>
                                    The password of the account is <span className="marker">*&lt;a1b2c3d4&gt;*</span>.<br/>
                                    Could you please help me operate it?
                                </div>
                                
                                <p className="text-xs text-slate-400 mt-2">ä½¿ç”¨ <span className="marker">*&lt;</span> å’Œ <span className="marker">&gt;*</span> æ ‡è®°éœ€è¦åŠ å¯†çš„éƒ¨åˆ†ã€‚</p>
                            </div>
                            
                            <div className="grid grid-cols-2 gap-4">
                                <div className="border border-slate-700 p-3 rounded bg-slate-800/50">
                                    <h5 className="font-semibold text-green-400 text-sm mb-2">éƒ¨åˆ†åŠ å¯†</h5>
                                    <button 
                                        onClick={() => handleSimulateCopy(testPartialText, "encrypt")}
                                        className="w-full text-left text-xs bg-slate-900 p-2 rounded hover:bg-slate-700 transition"
                                    >
                                        ğŸ‘‰ ç‚¹å‡»åŠ å¯†æ ‡è®°æ–‡æœ¬
                                    </button>
                                    <p className="text-xs text-slate-500 mt-2">åªæœ‰ *&lt; &gt;* å†…çš„å†…å®¹ä¼šè¢«åŠ å¯†</p>
                                </div>
                                
                                <div className="border border-slate-700 p-3 rounded bg-slate-800/50">
                                    <h5 className="font-semibold text-blue-400 text-sm mb-2">éƒ¨åˆ†è§£å¯†</h5>
                                    <button 
                                        onClick={() => handleSimulateCopy(testPartialCipher, "decrypt")}
                                        className="w-full text-left text-xs bg-slate-900 p-2 rounded hover:bg-slate-700 transition"
                                    >
                                        ğŸ‘‰ ç‚¹å‡»è§£å¯†å¯†æ–‡
                                    </button>
                                    <p className="text-xs text-slate-500 mt-2">è‡ªåŠ¨è¯†åˆ«å¹¶è§£å¯†åŠ å¯†éƒ¨åˆ†</p>
                                </div>
                            </div>
                        </div>
                    )
                },
                {
                    id: "file-crypto",
                    title: "ğŸ“ 4. æ–‡ä»¶ç»“æ„åŠ å¯†",
                    subtitle: "åŠ å¯†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ä¸º.denc.binå­˜æ¡£",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">åŠ å¯†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</h3>
                            <p className="text-slate-400">CryptoMessager æ”¯æŒåŠ å¯†æ•´ä¸ªæ–‡ä»¶ç»“æ„ä¸º .denc.bin å­˜æ¡£ã€‚</p>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-yellow-400 mb-2">æ–‡ä»¶åŠ å¯†ç¤ºä¾‹ï¼š</h4>
                                <div className="code-block text-sm">
                                    ã€selected files and foldersã€‘<br/>
                                    "D:/Emma/Love Letter.txt"<br/>
                                    "D:/President/Election Manifesto.mp4"<br/>
                                    "D:/Secret/Amazing Novels/"<br/>
                                    <br/>
                                    ã€encrypted cipher fileã€‘<br/>
                                    "Enc_2ba49be5dffb0338_Rdx6af8.denc.bin"  477MB
                                </div>
                                
                                <div className="mt-4 flex gap-2">
                                    <button 
                                        onClick={handleFileEncrypt}
                                        className="flex-1 bg-purple-600 hover:bg-purple-500 px-3 py-2 rounded text-sm"
                                    >
                                        æ¨¡æ‹Ÿæ–‡ä»¶åŠ å¯† (Ctrl+C)
                                    </button>
                                    <button 
                                        onClick={() => handleSimulateCopy("Enc_2ba49be5dffb0338_Rdx6af8.denc.bin", "decrypt")}
                                        className="flex-1 bg-green-600 hover:bg-green-500 px-3 py-2 rounded text-sm"
                                    >
                                        æ¨¡æ‹Ÿæ–‡ä»¶è§£å¯† (Ctrl+C)
                                    </button>
                                </div>
                            </div>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-blue-400 mb-2">æ–‡ä»¶åŠ å¯†ç‰¹ç‚¹ï¼š</h4>
                                <ul className="text-sm text-slate-300 space-y-2">
                                    <li className="flex items-start">
                                        <span className="text-green-400 mr-2">âœ“</span>
                                        <span>åŠ å¯†åçš„æ–‡ä»¶ä»¥ <span className="font-mono">.denc.bin</span> ç»“å°¾</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-green-400 mr-2">âœ“</span>
                                        <span>æ”¯æŒåŠ å¯†å¤šä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-green-400 mr-2">âœ“</span>
                                        <span>å¤§æ–‡ä»¶åŠ å¯†æ—¶æŒ‡ç¤ºç¯å˜ä¸ºé»„è‰²</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-green-400 mr-2">âœ“</span>
                                        <span>å†…ç½®æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥å’Œå¾ªç¯å†—ä½™æ·»åŠ åŠŸèƒ½</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    )
                },
                {
                    id: "text-to-file",
                    title: "ğŸ“„ 5. æ–‡æœ¬åˆ°æ–‡ä»¶åŠ å¯†",
                    subtitle: "å°†è¶…é•¿æ–‡æœ¬åŠ å¯†ä¸ºæ–‡ä»¶",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">åŠ å¯†è¶…é•¿æ–‡æœ¬ä¸ºæ–‡ä»¶</h3>
                            <p className="text-slate-400">è®¸å¤šåœ¨çº¿å¹³å°æœ‰æ¶ˆæ¯é•¿åº¦é™åˆ¶ï¼Œå¯ä»¥å°†è¶…é•¿æ–‡æœ¬åŠ å¯†ä¸ºæ–‡ä»¶ã€‚</p>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-yellow-400 mb-2">ä½¿ç”¨æ–¹æ³•ï¼š</h4>
                                <p className="text-sm text-slate-300 mb-2">æ–‡æœ¬ä»¥ <span className="marker">====!!!!</span> å¼€å¤´æˆ–ç»“å°¾æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ å¯†ä¸ºæ–‡ä»¶ã€‚</p>
                                
                                <div className="code-block text-sm">
                                    ã€ultra-long text with text-to-file notationã€‘<br/>
                                    <span className="marker">====!!!!</span>Emma, this is pi to 1'000'000 decimal places: 3.14159265358979323846264338327950288...
                                </div>
                                
                                <div className="mt-4">
                                    <h5 className="font-semibold text-green-400 text-sm mb-2">æµ‹è¯•æ–‡æœ¬è½¬æ–‡ä»¶ï¼š</h5>
                                    <div className="flex gap-2">
                                        <textarea 
                                            className="flex-1 bg-slate-900 border border-slate-600 rounded px-2 py-1 text-sm h-20" 
                                            value={testLongText}
                                            onChange={(e) => setTestLongText(e.target.value)}
                                        />
                                        <div className="flex flex-col gap-2">
                                            <button 
                                                onClick={() => handleSimulateCopy(`====!!!!${testLongText}`, "encrypt")}
                                                className="bg-pink-600 hover:bg-pink-500 px-3 py-1 rounded text-sm"
                                            >
                                                æ·»åŠ å‰ç¼€ ====!!!!
                                            </button>
                                            <button 
                                                onClick={() => handleSimulateCopy(`${testLongText}====!!!!`, "encrypt")}
                                                className="bg-pink-600 hover:bg-pink-500 px-3 py-1 rounded text-sm"
                                            >
                                                æ·»åŠ åç¼€ ====!!!!
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-blue-400 mb-2">è§£å¯†ç»“æœï¼š</h4>
                                <p className="text-sm text-slate-300">è§£å¯†åç”Ÿæˆä¸€ä¸ª txt æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰åŸå§‹æ–‡æœ¬ï¼ˆä¸å« <span className="marker">====!!!!</span> æ ‡è®°ï¼‰ã€‚</p>
                                <div className="code-block text-sm mt-2">
                                    ã€decrypted plain txt fileã€‘<br/>
                                    "TextFile_b59110a021b5cd45.txt"  976KB
                                </div>
                            </div>
                        </div>
                    )
                },
                {
                    id: "telepathy",
                    title: "ğŸ”— 6. SMS Code Telepathy",
                    subtitle: "å®‰å…¨çš„P2På¯†é’¥äº¤æ¢",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">å®‰å…¨çš„å¯†é’¥äº¤æ¢</h3>
                            <p className="text-slate-400">é€šè¿‡å®‰å…¨çš„ç½‘ç»œé€šä¿¡äº¤æ¢ SMS Codeï¼Œé™ä½æ˜æ–‡ SMS Code æ³„éœ²é£é™©ã€‚</p>
                            
                            <div className="grid grid-cols-2 gap-4">
                                <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                    <h4 className="font-semibold text-green-400 mb-2">ä½œä¸ºæœåŠ¡å™¨ (åˆ›å»ºé“¾æ¥)</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-xs text-slate-300">
                                        <li>ç‚¹å‡» <span className="font-bold">Share Me</span>ï¼Œé€‰æ‹©ä½¿ç”¨ Telepathy</li>
                                        <li>é€‰æ‹©æˆä¸ºæœåŠ¡å™¨ (åˆ›å»ºè€…)</li>
                                        <li>è¾“å…¥å¯†ç ä¿æŠ¤é“¾æ¥</li>
                                        <li>ç½‘ç»œæµ‹è¯•é€šè¿‡åç”Ÿæˆ Link Code</li>
                                        <li>å°† Link Code å’Œå¯†ç å‘é€ç»™å¯¹æ–¹</li>
                                    </ol>
                                    
                                    <div className="mt-4">
                                        <button 
                                            onClick={handleShareMe}
                                            className="w-full bg-blue-600 hover:bg-blue-500 px-3 py-2 rounded text-sm"
                                        >
                                            å¯åŠ¨ Telepathy æœåŠ¡å™¨
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                    <h4 className="font-semibold text-blue-400 mb-2">ä½œä¸ºè¿æ¥è€… (åŠ å…¥é“¾æ¥)</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-xs text-slate-300">
                                        <li>ä»æœåŠ¡å™¨è·å– Link Code å’Œå¯†ç </li>
                                        <li>å°† Link Code ç²˜è´´åˆ° Import æ¡†</li>
                                        <li>ç‚¹å‡» <span className="font-bold">New Client</span></li>
                                        <li>åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥å¯†ç (ç¤ºä¾‹é»˜è®¤TempPass123)</li>
                                        <li>ç­‰å¾…å¯†é’¥äº¤æ¢å®Œæˆ</li>
                                    </ol>
                                    
                                    <div className="mt-4">
                                        <input 
                                            type="text"
                                            placeholder="åœ¨æ­¤ç²˜è´´ Link Code..."
                                            className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-sm mb-2"
                                            value={linkCode}
                                            onChange={(e) => setLinkCode(e.target.value)}
                                        />
                                        <button 
                                            onClick={() => {
                                                setImportValue(linkCode);
                                                setTelepathyMode('client');
                                            }}
                                            className="w-full bg-green-600 hover:bg-green-500 px-3 py-2 rounded text-sm"
                                        >
                                            è¿æ¥ Telepathy é“¾æ¥
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="border border-red-700/30 p-4 rounded bg-red-900/20">
                                <h4 className="font-semibold text-red-400 mb-2">å¦‚æœ SMS Code æ³„éœ²æ€ä¹ˆåŠï¼Ÿ</h4>
                                <ul className="text-xs text-slate-300 space-y-1">
                                    <li className="flex items-start">
                                        <span className="text-red-400 mr-2">!</span>
                                        <span>ç«‹å³åœæ­¢ä½¿ç”¨å½“å‰è´¦æˆ·è¿›è¡ŒåŠ å¯†å’Œè§£å¯†</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-red-400 mr-2">!</span>
                                        <span>å°½å¯èƒ½æ§åˆ¶å¯†æ–‡çš„ä¼ æ’­</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-red-400 mr-2">!</span>
                                        <span>é€šçŸ¥ä½¿ç”¨ CryptoMessager çš„æœ‹å‹å’ŒåŒäº‹åˆ é™¤ä½ çš„ä¿¡æ¯</span>
                                    </li>
                                    <li className="flex items-start">
                                        <span className="text-red-400 mr-2">!</span>
                                        <span>æ›´æ”¹ Windows ç”¨æˆ·åä»¥ç»‘å®šæ–°çš„ SMS Code</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    )
                },
                {
                    id: "commands",
                    title: "âŒ¨ï¸ 7. å‘½ä»¤è¡Œä¸å¿«æ·é”®",
                    subtitle: "æ§åˆ¶å°å‘½ä»¤å’Œå¿«æ·é”®å‚æ•°",
                    content: (
                        <div className="space-y-4">
                            <h3 className="text-xl font-bold text-white">å‘½ä»¤è¡Œæ§åˆ¶</h3>
                            <p className="text-slate-400">åœ¨æ§åˆ¶å°ä¸­è¾“å…¥å‘½ä»¤æ¥æ“ä½œ CryptoMessagerã€‚</p>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-yellow-400 mb-2">å¸¸ç”¨å‘½ä»¤ï¼š</h4>
                                <div className="space-y-2 text-sm">
                                    <div className="grid grid-cols-3 gap-2">
                                        <div className="cmd-prompt">ON/OFF</div>
                                        <div className="col-span-2 cmd-output">å¼€å¯/å…³é—­å®æ—¶åŠ å¯†ç³»ç»Ÿ</div>
                                        
                                        <div className="cmd-prompt">SWITCH</div>
                                        <div className="col-span-2 cmd-output">åˆ‡æ¢åŠ å¯†ç³»ç»ŸçŠ¶æ€</div>
                                        
                                        <div className="cmd-prompt">MYSMS</div>
                                        <div className="col-span-2 cmd-output">æ˜¾ç¤ºä½ çš„ SMS Code</div>
                                        
                                        <div className="cmd-prompt">ADD &lt;code&gt;</div>
                                        <div className="col-span-2 cmd-output">æ·»åŠ å®¢æˆ·ç«¯ (SMS Code)</div>
                                        
                                        <div className="cmd-prompt">DIRECTLY</div>
                                        <div className="col-span-2 cmd-output">ç«‹å³åŠ å¯†/è§£å¯†å‰ªè´´æ¿å†…å®¹</div>
                                        
                                        <div className="cmd-prompt">CLS</div>
                                        <div className="col-span-2 cmd-output">æ¸…ç©ºæ§åˆ¶å°</div>
                                        
                                        <div className="cmd-prompt">CLC</div>
                                        <div className="col-span-2 cmd-output">æ¸…ç©ºå‰ªè´´æ¿</div>
                                        
                                        <div className="cmd-prompt">HELP</div>
                                        <div className="col-span-2 cmd-output">æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</div>
                                    </div>
                                </div>
                                
                                <div className="mt-4">
                                    <h5 className="font-semibold text-green-400 text-sm mb-2">åœ¨ä¸‹æ–¹è¾“å…¥å‘½ä»¤ï¼š</h5>
                                    <div className="flex">
                                        <span className="cmd-prompt bg-slate-900 px-2 py-1 rounded-l border border-slate-700">$</span>
                                        <input 
                                            ref={cmdInputRef}
                                            id="cmd-input"
                                            type="text"
                                            value={cmdInput}
                                            onChange={(e) => setCmdInput(e.target.value)}
                                            onKeyDown={(e) => {
                                                if (e.key === 'Enter') {
                                                    executeCommand(cmdInput);
                                                }
                                            }}
                                            className="flex-1 bg-slate-900 border border-slate-700 border-l-0 px-2 py-1 text-sm rounded-r focus:outline-none focus:ring-1 focus:ring-blue-500"
                                            placeholder="è¾“å…¥å‘½ä»¤ï¼ŒæŒ‰å›è½¦æ‰§è¡Œ (ä¾‹å¦‚: ON, OFF, HELP)"
                                            autoComplete="off"
                                        />
                                    </div>
                                    <p className="text-xs text-slate-500 mt-2">ä½¿ç”¨ â†‘â†“ ç®­å¤´é”®æµè§ˆå‘½ä»¤å†å²</p>
                                </div>
                            </div>
                            
                            <div className="border border-slate-700 p-4 rounded bg-slate-800/50">
                                <h4 className="font-semibold text-blue-400 mb-2">å¿«æ·é”®ï¼š</h4>
                                <div className="grid grid-cols-2 gap-3 text-sm">
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+O+P</div>
                                        <div className="text-xs text-slate-400">SWITCH - åˆ‡æ¢åŠ å¯†çŠ¶æ€</div>
                                    </div>
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+K+L</div>
                                        <div className="text-xs text-slate-400">CLS - æ¸…ç©ºæ§åˆ¶å°</div>
                                    </div>
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+K+K</div>
                                        <div className="text-xs text-slate-400">CLC - æ¸…ç©ºå‰ªè´´æ¿</div>
                                    </div>
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+E+E</div>
                                        <div className="text-xs text-slate-400">DIRECTLY - ç«‹å³åŠ å¯†/è§£å¯†</div>
                                    </div>
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+S+A</div>
                                        <div className="text-xs text-slate-400">SAVE - ä¿å­˜æ•°æ®åº“</div>
                                    </div>
                                    <div className="bg-slate-900 p-2 rounded">
                                        <div className="font-mono text-yellow-400">Ctrl+Alt+Q+Q</div>
                                        <div className="text-xs text-slate-400">QUIT - é€€å‡ºç¨‹åº</div>
                                    </div>
                                </div>
                                
                                <div className="mt-4 text-xs text-slate-400">
                                    <p>æç¤ºï¼šåœ¨æœ¬æ¨¡æ‹Ÿå™¨ä¸­ï¼Œéƒ¨åˆ†å¿«æ·é”®å·²å¯ç”¨ã€‚å°è¯•æŒ‰ <span className="font-mono bg-slate-800 px-1 rounded">Ctrl+Alt+O+P</span> åˆ‡æ¢åŠ å¯†çŠ¶æ€ã€‚</p>
                                </div>
                            </div>
                        </div>
                    )
                }
            ];

            return (
                <div className="flex flex-col md:flex-row h-screen font-sans">
                    {/* --- å·¦ä¾§æ•™ç¨‹æ  (ç°ä»£æš—é»‘é£æ ¼) --- */}
                    <div className="flex-1 flex flex-col md:w-5/12 h-full bg-slate-900 border-r border-slate-800 overflow-y-auto">
                        <header className="p-6 border-b border-slate-800 bg-slate-900/90 backdrop-blur sticky top-0 z-10">
                            <h1 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-indigo-400">
                                CryptoMessager æ¨¡æ‹Ÿå™¨ v0.0.1.3
                            </h1>
                            <p className="text-xs text-slate-500 mt-1">äº¤äº’å¼å­¦ä¹ å¹³å° - æ”¯æŒå‘½ä»¤è¡Œå’Œå¿«æ·é”®</p>
                            
                            <div className="flex items-center mt-4">
                                <div className={`w-3 h-3 rounded-full mr-2 ${clients.length > 0 ? 'bg-green-500' : 'bg-red-500'}`}></div>
                                <span className="text-xs text-slate-400 mr-4">
                                    {clients.length > 0 ? `${clients.length} ä¸ªå®¢æˆ·ç«¯å·²æ·»åŠ ` : 'æœªæ·»åŠ å®¢æˆ·ç«¯'}
                                </span>
                                <div className={`w-3 h-3 rounded-full mr-2 ${isCryptoOn ? 'bg-red-500' : 'bg-green-500'}`}></div>
                                <span className="text-xs text-slate-400">
                                    åŠ å¯†ç³»ç»Ÿ: {isCryptoOn ? 'å¼€å¯' : 'å…³é—­'}
                                </span>
                            </div>
                        </header>

                        <div className="p-6 pb-32">
                            {/* å¯¼èˆª Tabs */}
                            <div className="flex flex-wrap gap-2 mb-6">
                                {sections.map((sec, idx) => (
                                    <button 
                                        key={idx}
                                        onClick={() => setActiveSection(idx)}
                                        className={`px-3 py-2 rounded-lg text-xs font-semibold transition-colors flex flex-col items-start text-left ${activeSection === idx ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}
                                    >
                                        <span className="font-bold">{sec.title}</span>
                                        <span className="text-[10px] opacity-80 mt-0.5">{sec.subtitle}</span>
                                    </button>
                                ))}
                            </div>

                            {/* å†…å®¹åŒº */}
                            <div className="animate-fade-in">
                                {sections[activeSection].content}
                            </div>

                            {/* åº•éƒ¨å¯¼èˆª */}
                            <div className="flex justify-between mt-8 pt-6 border-t border-slate-800">
                                <button 
                                    disabled={activeSection === 0} 
                                    onClick={() => setActiveSection(p => p - 1)}
                                    className="text-sm text-slate-400 hover:text-white disabled:opacity-30 flex items-center"
                                >
                                    <i className="ri-arrow-left-line mr-1"></i> ä¸Šä¸€èŠ‚
                                </button>
                                <div className="text-xs text-slate-500">
                                    ç¬¬ {activeSection + 1} èŠ‚ / å…± {sections.length} èŠ‚
                                </div>
                                <button 
                                    disabled={activeSection === sections.length - 1} 
                                    onClick={() => setActiveSection(p => p + 1)}
                                    className="text-sm bg-blue-600 px-4 py-1.5 rounded hover:bg-blue-500 disabled:opacity-30 disabled:bg-slate-700 flex items-center"
                                >
                                    ä¸‹ä¸€èŠ‚ <i className="ri-arrow-right-line ml-1"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* --- å³ä¾§æ¨¡æ‹Ÿå™¨åŒºåŸŸ (å¯æ»‘åŠ¨) --- */}
                    <div ref={rightPanelRef} className="md:w-7/12 bg-[#202020] overflow-y-auto">
                        <div className="min-h-full flex flex-col items-center justify-center p-4 md:p-10">
                            {/* 1. çœŸå® GUI å®¹å™¨ (Windows çª—ä½“æ ·å¼) */}
                            <div className="bg-[#f0f0f0] w-full max-w-[650px] shadow-2xl rounded-sm border border-gray-400 win-font text-black select-none mb-6">
                                
                                {/* Title Bar */}
                                <div className="flex justify-between items-center px-3 py-2 bg-white border-b border-gray-300">
                                    <div className="flex items-center gap-2">
                                        <div className="w-5 h-5 bg-blue-500 rounded-sm flex items-center justify-center text-white text-xs font-bold">ğŸ›¡ï¸</div>
                                        <span className="text-sm text-gray-700">CryptoMessager_GUI Version 0.0.1.3</span>
                                        <span className="text-xs text-gray-500 ml-2">{
                                            isCryptoOn ? 'ç›‘æ§ä¸­...' : 'å°±ç»ª'
                                        }</span>
                                    </div>
                                    <div className="flex gap-4 text-gray-400 text-lg">
                                        <button className="hover:text-black">-</button>
                                        <button className="hover:text-black">â–¡</button>
                                        <button className="hover:text-red-500">Ã—</button>
                                    </div>
                                </div>

                                {/* Main Body */}
                                <div className="p-4 space-y-3">
                                    
                                    {/* Row 1: Import */}
                                    <div className="flex items-center gap-2 h-8">
                                        <label className="w-16 text-right font-serif text-lg">Import:</label>
                                        <input 
                                            type="text" 
                                            value={importValue}
                                            onChange={(e) => setImportValue(e.target.value)}
                                            className="flex-1 h-full border border-gray-400 px-1 text-sm bg-white placeholder-gray-400" 
                                            placeholder="Add a client by entering a SMS Code or Link Code here."
                                        />
                                        <button onClick={handleNewClient} className="win-btn w-28 h-full font-serif text-lg">New Client</button>
                                    </div>

                                    {/* Row 2: Delete */}
                                    <div className="flex items-center gap-2 h-8">
                                        <label className="w-16 text-right font-serif text-lg">Delete:</label>
                                        <input type="text" className="flex-1 h-full border border-gray-400 px-1 text-sm bg-white placeholder-gray-400" placeholder="Delete a client by entering a DEL Code here." />
                                        <button onClick={handleDeleteMe} className="win-btn w-28 h-full font-serif text-lg">Del Client</button>
                                    </div>

                                    {/* Row 3: ON/OFF Big Button & Status */}
                                    <div className="flex items-start gap-2 mt-2">
                                        <label className="w-16 text-right font-serif text-lg mt-2">ON/OFF:</label>
                                        
                                        {/* The Big Button */}
                                        <button 
                                            onClick={toggleCrypto}
                                            className={`flex-1 h-24 big-switch text-5xl text-black relative active:top-[1px] font-sans ${statusBusy ? 'pulse' : ''}`}
                                            disabled={statusBusy}
                                        >
                                            {isCryptoOn ? 'ON' : 'OFF'}
                                        </button>

                                        {/* Status Area */}
                                        <div className="w-28 flex flex-col gap-1">
                                            <label className="font-serif text-lg">Status:</label>
                                            <div className="status-box" style={{ backgroundColor: statusColor }}></div>
                                        </div>
                                    </div>

                                    {/* Row 4: Console & Right Buttons */}
                                    <div className="flex items-start gap-2 mt-2 h-64">
                                        <label className="w-16 text-right font-serif text-lg">Console:</label>
                                        
                                        {/* Console Output */}
                                        <div className="flex-1 h-full border-2 border-gray-400 bg-white p-1 overflow-y-auto win-mono text-sm leading-tight">
                                            {consoleLogs.map((log, i) => (
                                                <div key={i} className={
                                                    log.startsWith("!!") ? "text-red-600" :
                                                    log.startsWith("<<") ? "text-green-600" :
                                                    log.startsWith("??") ? "text-amber-600" :
                                                    log.startsWith("$") ? "text-blue-600" :
                                                    log.includes("ERROR") ? "text-red-600" :
                                                    log.includes("SUCCESS") ? "text-green-600" :
                                                    log.includes("WARNING") ? "text-amber-600" :
                                                    "text-black"
                                                }>{log}</div>
                                            ))}
                                            <div ref={consoleEndRef}></div>
                                        </div>

                                        {/* Right Side Button Stack */}
                                        <div className="w-28 flex flex-col gap-2">
                                            <button onClick={handleShareMe} className="win-btn h-8 font-serif text-lg">Share Me</button>
                                            <button onClick={handleDeleteMe} className="win-btn h-8 font-serif text-lg">Delete Me</button>
                                            <button onClick={() => executeCommand("DIRECTLY")} className="win-btn h-8 font-serif text-lg">Directly</button>
                                            <button onClick={() => executeCommand("INFO")} className="win-btn h-8 font-serif text-lg">Ret Info</button>
                                            <div className="h-2"></div> {/* Spacer */}
                                            <button className="win-btn h-8 font-serif text-lg">View Log</button>
                                            <button className="win-btn h-8 font-serif text-lg">Clear Log</button>
                                            <button onClick={handleClearConsole} className="win-btn h-8 font-serif text-lg">Clr Consol</button>
                                        </div>
                                    </div>
                                    
                                    {/* Client List */}
                                    {clients.length > 0 && (
                                        <div className="mt-2 border border-gray-300 p-2 bg-white">
                                            <div className="font-serif text-lg mb-1">å·²æ·»åŠ å®¢æˆ·ç«¯:</div>
                                            <div className="text-sm">
                                                {clients.map(client => (
                                                    <div key={client.id} className="flex items-center py-1 border-b border-gray-100 last:border-0">
                                                        <div className="w-2 h-2 rounded-full bg-green-500 mr-2"></div>
                                                        <span>{client.name}</span>
                                                        <span className="text-gray-500 text-xs ml-2 truncate" title={client.code}>
                                                            ({client.code.substring(0, 20)}...)
                                                        </span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* 2. è™šæ‹Ÿå‰ªè´´æ¿ç›‘æ§ (è¾…åŠ©å·¥å…·) */}
                            <div className="w-full max-w-[650px] mt-6 bg-black rounded-lg border border-slate-700 p-4 shadow-xl">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-xs font-mono text-green-400">
                                        <i className="ri-clipboard-line mr-1"></i>SYSTEM CLIPBOARD MONITOR
                                    </span>
                                    <span className="text-[10px] text-slate-500">
                                        çŠ¶æ€: {isCryptoOn ? 'åŠ å¯†ç›‘æ§å¼€å¯' : 'åŠ å¯†ç›‘æ§å…³é—­'} | 
                                        å®¢æˆ·ç«¯: {clients.length} | 
                                        {statusBusy && <span className="text-yellow-400 ml-1"> å¤„ç†ä¸­...</span>}
                                    </span>
                                </div>
                                <textarea 
                                    readOnly
                                    value={virtualClipboard}
                                    className="w-full h-24 bg-slate-900 text-slate-300 font-mono text-xs p-2 rounded border border-slate-800 focus:outline-none resize-none"
                                    placeholder="ç­‰å¾…å¤åˆ¶æ“ä½œ..."
                                ></textarea>
                                <div className="flex justify-between mt-2 text-xs text-slate-500">
                                    <span>å‰ªè´´æ¿å†…å®¹ä¼šåœ¨æ­¤æ˜¾ç¤º</span>
                                    <button 
                                        onClick={() => setVirtualClipboard("")}
                                        className="text-slate-400 hover:text-white"
                                    >
                                        æ¸…ç©ºå‰ªè´´æ¿
                                    </button>
                                </div>
                            </div>
                            
                            {/* 3. å¿«é€Ÿæµ‹è¯•é¢æ¿ */}
                            <div className="w-full max-w-[650px] mt-4 grid grid-cols-2 gap-3">
                                <div className="bg-slate-900/50 p-3 rounded border border-slate-700">
                                    <div className="text-xs text-slate-400 mb-1">åŠ å¯†æµ‹è¯•</div>
                                    <button 
                                        onClick={() => handleSimulateCopy("Hello CryptoMessager!", "encrypt")}
                                        className="w-full text-left text-xs bg-slate-800 p-2 rounded hover:bg-slate-700 transition"
                                    >
                                        ğŸ”’ åŠ å¯†: Hello CryptoMessager!
                                    </button>
                                </div>
                                <div className="bg-slate-900/50 p-3 rounded border border-slate-700">
                                    <div className="text-xs text-slate-400 mb-1">è§£å¯†æµ‹è¯•</div>
                                    <button 
                                        onClick={() => handleSimulateCopy(testCiphertext, "decrypt")}
                                        className="w-full text-left text-xs bg-slate-800 p-2 rounded hover:bg-slate-700 transition"
                                    >
                                        ğŸ”“ è§£å¯†ç¤ºä¾‹å¯†æ–‡
                                    </button>
                                </div>
                            </div>
                            
                            {/* 4. å¿«æ·é”®æç¤º */}
                            <div className="w-full max-w-[650px] mt-6 p-4 bg-slate-900/30 rounded border border-slate-700">
                                <div className="text-xs text-slate-400 mb-2">å¿«æ·é”®æç¤º: </div>
                                <div className="grid grid-cols-3 gap-2 text-xs">
                                    <div className="flex items-center">
                                        <kbd className="bg-slate-800 px-2 py-1 rounded mr-2">Ctrl+Alt+O+P</kbd>
                                        <span className="text-slate-300">åˆ‡æ¢åŠ å¯†</span>
                                    </div>
                                    <div className="flex items-center">
                                        <kbd className="bg-slate-800 px-2 py-1 rounded mr-2">Ctrl+Alt+K+L</kbd>
                                        <span className="text-slate-300">æ¸…ç©ºæ§åˆ¶å°</span>
                                    </div>
                                    <div className="flex items-center">
                                        <kbd className="bg-slate-800 px-2 py-1 rounded mr-2">Ctrl+Alt+E+E</kbd>
                                        <span className="text-slate-300">ç«‹å³åŠ /è§£å¯†</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
